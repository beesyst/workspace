# Linux: Полезные команды для администрирования и DevOps

## Оглавление

- [Основные команды](#%D0%9E%D1%81%D0%BD%D0%BE%D0%B2%D0%BD%D1%8B%D0%B5-%D0%BA%D0%BE%D0%BC%D0%B0%D0%BD%D0%B4%D1%8B)
- [Процессы и диагностика](#%D0%9F%D1%80%D0%BE%D1%86%D0%B5%D1%81%D1%81%D1%8B-%D0%B8-%D0%B4%D0%B8%D0%B0%D0%B3%D0%BD%D0%BE%D1%81%D1%82%D0%B8%D0%BA%D0%B0)
- [Сеть и безопасность](#%D0%A1%D0%B5%D1%82%D1%8C-%D0%B8-%D0%B1%D0%B5%D0%B7%D0%BE%D0%BF%D0%B0%D1%81%D0%BD%D0%BE%D1%81%D1%82%D1%8C)
- [Контейнеры (Docker / Podman / Kubernetes / CRI)](#%D0%9A%D0%BE%D0%BD%D1%82%D0%B5%D0%B9%D0%BD%D0%B5%D1%80%D1%8B-docker--podman--kubernetes--cri)
- [Файлы и операции](#%D0%A4%D0%B0%D0%B9%D0%BB%D1%8B-%D0%B8-%D0%BE%D0%BF%D0%B5%D1%80%D0%B0%D1%86%D0%B8%D0%B8)
- [Git и разработка](#git-%D0%B8-%D1%80%D0%B0%D0%B7%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D0%BA%D0%B0)
- [Часто используемые сценарии](#%D0%A7%D0%B0%D1%81%D1%82%D0%BE-%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D0%BC%D1%8B%D0%B5-%D1%81%D1%86%D0%B5%D0%BD%D0%B0%D1%80%D0%B8%D0%B8)
  - [Найти процесс по имени](#%D0%9D%D0%B0%D0%B9%D1%82%D0%B8-%D0%BF%D1%80%D0%BE%D1%86%D0%B5%D1%81%D1%81-%D0%BF%D0%BE-%D0%B8%D0%BC%D0%B5%D0%BD%D0%B8)
  - [Проверить, кто держит порт 8080](#%D0%9F%D1%80%D0%BE%D0%B2%D0%B5%D1%80%D0%B8%D1%82%D1%8C-%D0%BA%D1%82%D0%BE-%D0%B4%D0%B5%D1%80%D0%B6%D0%B8%D1%82-%D0%BF%D0%BE%D1%80%D1%82-8080)
  - [Мониторинг логов](#%D0%9C%D0%BE%D0%BD%D0%B8%D1%82%D0%BE%D1%80%D0%B8%D0%BD%D0%B3-%D0%BB%D0%BE%D0%B3%D0%BE%D0%B2)
  - [Проверить проблемные контейнеры](#%D0%9F%D1%80%D0%BE%D0%B2%D0%B5%D1%80%D0%B8%D1%82%D1%8C-%D0%BF%D1%80%D0%BE%D0%B1%D0%BB%D0%B5%D0%BC%D0%BD%D1%8B%D0%B5-%D0%BA%D0%BE%D0%BD%D1%82%D0%B5%D0%B9%D0%BD%D0%B5%D1%80%D1%8B)
  - [Анализ сетевых пакетов по интерфейсу eth0](#%D0%90%D0%BD%D0%B0%D0%BB%D0%B8%D0%B7-%D1%81%D0%B5%D1%82%D0%B5%D0%B2%D1%8B%D1%85-%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2-%D0%BF%D0%BE-%D0%B8%D0%BD%D1%82%D0%B5%D1%80%D1%84%D0%B5%D0%B9%D1%81%D1%83-eth0)

---

## Основные команды

| Команда | Описание |
|----------|-----------|
| `sudo !!` | Повтор последней команды с правами root |
| `ctrl + r` | Поиск по истории команд |
| `history \| grep` | Фильтрация истории |
| `alias` | Создание коротких команд |
| `watch` | Повторное выполнение команды через интервал |
| `uptime` | Проверка времени работы и средней нагрузки |
| `top -c` | Просмотр процессов в реальном времени |
| `htop` | Улучшенная версия top |
| `free -h` | Проверка использования памяти |
| `df -h` | Проверить свободное место на диске |
| `vmstat 1` | Мониторинг метрик системы в реальном времени |
| `dmesg -T \| tail` | Последние сообщения ядра |

## Процессы и диагностика

| Команда | Описание |
|----------|-----------|
| `ps aux \| grep {process}` | Найти нужный процесс |
| `strace -p {pid}` | Отслеживание системных вызовов процесса |
| `lsof -i :{port}` | Проверить, кто использует порт |
| `less +F` | Альтернатива `tail -f` с прокруткой |
| `tail -f /var/log/*` | Просмотр логов в реальном времени |
| `journalctl -fu service-name` | Отслеживание логов systemd-сервиса |
| `grep -r "error" .` | Поиск ошибок в файлах |
| `zcat access.log.gz \| grep "500"` | Анализ сжатых логов |
| `sar -n DEV 1` | Статистика по сетевым интерфейсам |
| `iostat -xz 1` | Анализ производительности дисков |
| `ps --forest -C nginx -o ppid,pid,cmd,etime` | Скколько времени работает процесс Nginx |

## Сеть и безопасность

| Команда | Описание |
|----------|-----------|
| `netstat -tulpn` | Показать активные сетевые соединения |
| `ss -tunlp` | Просмотр открытых сокетов (альтернатива netstat) |
| `iptables -L` | Отображение правил фаервола |
| `tcpdump -i any` | Анализ сетевых пакетов |
| `traceroute {host}` | Трассировка маршрута до хоста |
| `dig +short {domain}` | Быстрый DNS-запрос |
| `curl -v {url}` | Отладка HTTP-запросов |

## Контейнеры (Docker / Podman / Kubernetes / CRI)

| Команда | Описание |
|----------|-----------|
| `docker ps --format '{{.Names}} {{.Status}}'` | Краткий статус контейнеров |
| `docker stats --no-stream` | Быстрое использование ресурсов |
| `docker exec -it {container} bash` | Войти в контейнер |
| `docker logs -f {container}` | Просмотр логов контейнера |
| `podman top` | Просмотр процессов внутри контейнера |
| `crictl logs {container}` | Логи контейнера (CRI runtimes) |
| `kubectl get pods \| grep -i error` | Найти ошибочные Pod’ы в Kubernetes |

## Файлы и операции

| Команда | Описание |
|----------|-----------|
| `find . -name "*.yaml" -type f` | Поиск файлов по шаблону |
| `rsync -avz source/ dest/` | Надёжное копирование данных |
| `tar -xvf file.tar.gz` | Распаковка архива |
| `ln -s target link_name` | Создание символической ссылки |
| `chmod +x script.sh` | Сделать файл исполняемым |

## Git и разработка

| Команда | Описание |
|----------|-----------|
| `git log --oneline` | Компактный вывод истории |
| `git reset --hard HEAD^` | Отмена последнего коммита |
| `git stash` | Временно скрыть изменения |
| `git diff --cached` | Сравнение проиндексированных файлов |
| `git blame {file}` | Кто и когда менял строки файла |

## Часто используемые сценарии

### Найти процесс по имени

```
bash
ps aux | grep nginx
```

### Проверить, кто держит порт 8080

```
lsof -i :8080
```

### Мониторинг логов

```
journalctl -fu nginx
```

### Проверить проблемные контейнеры

```
docker ps --format '{{.Names}} {{.Status}}' | grep -v Up
```

### Анализ сетевых пакетов по интерфейсу eth0

```
tcpdump -i eth0 port 80
```